# Project: adams
# Date: 2015-07-19 20:18:51
# User: fracpete
#
adams.flow.control.Flow
	-annotation
	Tracks an object throughout a movie using a predefined, initial location.\nFurther, a blur filter is applied to the tracked object.
	-actor
		adams.flow.standalone.CallableActors
			-actor
				adams.flow.sink.ImageViewer
					-name
					Blurred
					-short-title
					true
					-writer
						adams.gui.print.NullWriter
					-zoom
					-1.0
					-selection-processor
						adams.gui.visualization.image.selection.NullProcessor
					-image-overlay
						adams.gui.visualization.image.QuadrilateralLocationsOverlayFromReport
							-regexp
							Tracker\\.Current
			-actor
				adams.flow.sink.Display
					-name
					Locations
					-x
					-3
					-writer
						adams.data.io.output.NullWriter
			-actor
				adams.flow.transformer.BufferedImageTransformer
					-name
					blur
					-transformer
						adams.data.image.transformer.GaussianBlur
							-radius
							10.0
	-actor
		adams.flow.source.Start
	-actor
		adams.flow.control.Trigger
			-name
			load initial position
			-tee
				adams.flow.source.FileSupplier
					-file
					${EXAMPLE_FLOWS}/data/track_book_rect.txt
			-tee
				adams.flow.transformer.TextFileReader
					-reader
						adams.data.io.input.SingleStringTextReader
			-tee
				adams.flow.transformer.StringTrim
			-tee
				adams.flow.transformer.SetVariable
					-var-name
					pos
	-actor
		adams.flow.control.Trigger
			-name
			track
			-tee
				adams.flow.source.FileSupplier
					-file
					${EXAMPLE_FLOWS}/data/track_book.mjpeg
			-tee
				adams.flow.transformer.MjpegImageSequence
					-output-type
					BOTH
			-tee
				adams.flow.control.Sleep
					-interval
					10
			-tee
				adams.flow.control.Tee
					-name
					gui image
					-annotation
					rather than the displaying the frame, we want to display the nice GUI image
					-tee
						adams.flow.transformer.GetArrayElement
							-index
							2
					-tee
						adams.flow.transformer.SetStorageValue
							-storage-name
							image
			-tee
				adams.flow.transformer.GetArrayElement
			-tee
				adams.flow.control.Once
					-tee
						adams.flow.transformer.SetReportValue
							-field
							Tracker.Init[S]
							-value
							@{pos}
			-tee
				adams.flow.transformer.TrackObjects
					-algorithm
						adams.flow.transformer.objecttracker.BoofCVCirculant
			-tee
				adams.flow.transformer.TransformTrackedObject
					-transformer
					blur
			-tee
				adams.flow.control.Tee
					-name
					get location
					-tee
						adams.flow.transformer.GetReportValue
							-field
							Tracker.Current[S]
					-tee
						adams.flow.transformer.SetVariable
							-var-name
							current
			-tee
				adams.flow.control.Branch
					-branch
						adams.flow.sink.CallableSink
							-callable
							Blurred
					-branch
						adams.flow.control.Sequence
							-name
							location
							-actor
								adams.flow.transformer.GetReportValue
									-field
									Tracker.Current[S]
							-actor
								adams.flow.sink.CallableSink
									-callable
									Locations
	-flow-execution-listener
		adams.flow.execution.NullListener

