# Project: adams
# Date: 2015-09-26 18:34:55
# User: fracpete
# Charset: UTF-8
#
adams.flow.control.Flow
	-annotation
	Uses the OpenIMAJ HaarCascade face detector to \ndetect the initial location of the face for the tracker.
	-actor
		adams.flow.standalone.CallableActors
			-actor
				adams.flow.sink.ImageViewer
					-name
					Frame
					-short-title
					true
					-writer
						adams.gui.print.NullWriter
					-zoom
					-1.0
					-selection-processor
						adams.gui.visualization.image.selection.NullProcessor
					-image-overlay
						adams.gui.visualization.image.QuadrilateralLocationsOverlayFromReport
							-regexp
							Tracker\\.Current
			-actor
				adams.flow.sink.ImageViewer
					-name
					Object
					-short-title
					true
					-y
					-3
					-writer
						adams.gui.print.NullWriter
					-zoom
					-1.0
					-selection-processor
						adams.gui.visualization.image.selection.NullProcessor
					-image-overlay
						adams.gui.visualization.image.QuadrilateralLocationsOverlayFromReport
							-regexp
							Tracker\\.Current
			-actor
				adams.flow.sink.Display
					-name
					Locations
					-x
					-3
					-writer
						adams.data.io.output.NullWriter
	-actor
		adams.flow.source.FileSupplier
			-file
			${EXAMPLE_FLOWS}/data/track_peter.mjpeg
	-actor
		adams.flow.transformer.MjpegImageSequence
			-output-type
			FRAME
	-actor
		adams.flow.transformer.BufferedImageTransformer
			-transformer
				adams.data.jai.transformer.Brightness
					-factor
					1.5
	-actor
		adams.flow.transformer.Convert
			-conversion
				adams.data.conversion.BufferedImageToBoofCV
	-actor
		adams.flow.transformer.SetStorageValue
			-storage-name
			frame
	-actor
		adams.flow.control.Once
			-name
			locate face
			-tee
				adams.flow.transformer.LocateObjects
					-output-array
					true
					-locator
						adams.flow.transformer.locateobjects.OpenIMAJFaceDetector
							-detector
								adams.data.openimaj.facedetector.HaarCascade
			-tee
				adams.flow.transformer.GetArrayElement
			-tee
				adams.flow.transformer.GetReportValue
					-field
					Location[S]
			-tee
				adams.flow.transformer.SetVariable
					-var-name
					location
			-tee
				adams.flow.control.Trigger
					-name
					set initial location for tracker
					-tee
						adams.flow.source.StorageValue
							-storage-name
							frame
					-tee
						adams.flow.transformer.SetReportValue
							-field
							Tracker.Init[S]
							-value
							@{location}
					-tee
						adams.flow.transformer.SetStorageValue
							-storage-name
							frame
	-actor
		adams.flow.control.Trigger
			-name
			track
			-tee
				adams.flow.source.StorageValue
					-storage-name
					frame
			-tee
				adams.flow.transformer.TrackObjects
					-algorithm
						adams.flow.transformer.objecttracker.BoofCVCirculant
			-tee
				adams.flow.control.Branch
					-branch
						adams.flow.control.Sequence
							-name
							image
							-actor
								adams.flow.sink.CallableSink
									-callable
									Frame
					-branch
						adams.flow.control.Sequence
							-name
							object
							-actor
								adams.flow.transformer.ExtractTrackedObject
							-actor
								adams.flow.sink.CallableSink
									-callable
									Object
					-branch
						adams.flow.control.Sequence
							-name
							location
							-actor
								adams.flow.transformer.GetReportValue
									-field
									Tracker.Current[S]
							-actor
								adams.flow.sink.CallableSink
									-callable
									Locations
	-flow-execution-listener
		adams.flow.execution.NullListener

